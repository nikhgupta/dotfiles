#!/usr/bin/env zsh
#
# ZSH Configuration for Nikhil Gupta.
#
#   <http://github.com/nikhgupta>
#
# ===================================

# Dependencies {{{
# - cowsay
# - fortune
# - dos2unix
# - http://sferik.github.com/t
# }}}
# Behaviour: Basic locales and ZSH options {{{
LANG=en_US.UTF-8
LC_ALL=en_US.UTF-8
skip_global_compinit=1

# Reference: http://zsh.sourceforge.net/Doc/Release/Options.html
setopt auto_pushd               # cd pushes the old directory onto directory stack
setopt pushd_silent             # be quiet when using pushd
setopt pushd_ignore_dups        # only push unique values in directorys stack
setopt menu_complete            # complete first option when ambiguous
setopt hist_expire_dups_first   # expire older dup commands first in history
setopt hist_find_no_dups        # do not find dupes when searching history
setopt hist_ignore_space        # do not add commands with a leading space in history
setopt hist_no_store            # do not add 'history' command in history
setopt rm_star_wait             # wait for 10 seconds before accepting the answer
unsetopt rm_star_silent         # Query the user on such a removal
unsetopt nomatch
unsetopt correct_all

unalias run-help &>/dev/null
autoload run-help
HELPDIR=/usr/local/share/zsh/help

# other terminal related basic configuration
typeset -U path # set $path variable to only have unique values
export TERM=xterm-256color
# }}}
# # Behaviour: Vim Key bindings in ZSH {{{
# bindkey -v
# zle_default_mode='ins'
# zle_ins_more_like_emacs='yes'
# bindkey -M viins 'jj' vi-cmd-mode
# bindkey '\e[A' history-beginning-search-backward
# bindkey '\e[B' history-beginning-search-forward
# bindkey '^R' history-incremental-search-backward
# # }}}
# Behaviour: Custom variables {{{
export EDITOR="vim"
export DEV_SERVER=0
export ZSH_THEME="blinks"
export SSH_KEY="$HOME/.ssh/`whoami`.pub"
export DISABLE_UPDATE_PROMPT=true # auto update


# Which OS?
[[ `uname -a` =~ "Darwin" ]] && export ZSH_OS='macosx'
[[ `uname -a` =~ "Ubuntu" ]] && export ZSH_OS='ubuntu' 

# zsh_debug_time "Environment variables exported"
# }}}
# Behaviour: GUI {{{
# Base16 Shell
BASE16_SCHEME="eighties"
BASE16_SHELL="$HOME/.config/base16-shell/base16-$BASE16_SCHEME.dark.sh"
[[ -s $BASE16_SHELL ]] && . $BASE16_SHELL
# zsh_debug_time "Base16 Shell loaded"
# }}}
# Behaviour: ZSH Plug-ins {{{
# TODO: move osx specific plugins to separate file.
plugins=(fasd battery brew coffee colored-man composer copydir
copyfile cp extract gem git-flow git-extras git github gitignore heroku
history-substring-search osx rails systemadmin thor vundle web-search
zsh-syntax-highlighting)
# }}}
# Behaviour: Source files before ZSH configuration is really loaded {{{
# load OhMyZSH, because its auwesomeeee :)
source_file "$ZSH/oh-my-zsh.sh"
source_file "$HOME/.zshrc.before"
# }}}

# Behaviour: Source files after ZSH configuration has been loaded {{{
for config_file in config prompt scripts functions aliases via_terminal; do
  source_file $ZSH_DIR/common/$config_file.zsh
  source_file $ZSH_DIR/$ZSH_OS/$config_file.zsh
done
# (create, if required) specify any other commands or configuration options here...
source_file "$HOME/.zshrc.after"   # keep over-riding or custom settings here
source_file "$HOME/.localrc.after" # keep over-riding or custom exports here
# }}}
# Behaviour: ZSH auto-completion {{{
# complete -F _todo t # for todo.txt-cli
# for twitter client: t
# }}}
# Behaviour: Miscelleneous {{{
if [ -f ~/.zsh_nocorrect ]; then
    while read -r COMMAND; do
        alias $COMMAND="nocorrect $COMMAND"
    done < ~/.zsh_nocorrect
fi
# }}}

# zsh_debug_time "ZSH Configuration loaded"
# unset zsh_start_timer; unset zsh_timer
